//------------------------------------------------------------------------------
// <auto-generated>
//     This code was not generated by a tool. but for stylecop suppression.
// </auto-generated>
//------------------------------------------------------------------------------
using Moq;
using StrixIT.Platform.Core;
using System.Collections.Generic;
using System.Security.Principal;
using System.Linq;

namespace StrixIT.Platform.Modules.Membership.Tests
{
    public class UserManagerMock
    {
        private IUserManager _userManager;
        private DataSourceMock _dataSourceMock = new DataSourceMock();
        private Mock<IUserManager> _userManagerMock = new Mock<IUserManager>();
        private Mock<ISecurityManager> _securityManagerMock = new Mock<ISecurityManager>();

        public UserManagerMock()
        {
            var users = MembershipTestData.Users;
            _dataSourceMock.RegisterData<User>(users);
            _dataSourceMock.RegisterData<UserSecurity>(MembershipTestData.UserSecurity);
            _dataSourceMock.RegisterData<UserSessionStorage>(MembershipTestData.Sessions);
            _dataSourceMock.Mock.Setup(m => m.Query<User>(It.IsAny<string>())).Returns(_dataSourceMock.DataList<User>().AsQueryable());
            _dataSourceMock.Mock.Setup(d => d.Save<User>(It.IsAny<User>())).Returns<User>(u => u);
            _dataSourceMock.Mock.Setup(d => d.Save<UserSecurity>(It.IsAny<UserSecurity>())).Returns<UserSecurity>(s => s);
            _dataSourceMock.Mock.Setup(d => d.Save<UserSessionStorage>(It.IsAny<UserSessionStorage>())).Returns<UserSessionStorage>(s => s);
            _userManager = new UserManager(_dataSourceMock.Mock.Object, _securityManagerMock.Object);
        }

        #region Properties

        public IUserManager UserManager
        {
            get
            {
                return _userManager;
            }
        }

        public Mock<IUserManager> Mock
        {
            get
            {
                return _userManagerMock;
            }
        }

        internal DataSourceMock DataSourceMock
        {
            get
            {
                return _dataSourceMock;
            }
        }

        #endregion
    }
}
